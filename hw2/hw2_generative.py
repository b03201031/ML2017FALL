import data_preprocessing as DP
import numpy as np
import pandas as pd
import math
import sys

##C1 is type 1 here
PATH_X_TRAIN_C1 = "X_train_type_1.csv"
PATH_X_TRAIN_C2 = "X_train_type_0.csv"
PATH_X_TRAIN_ALL = "X_train.csv"
PATH_X_TEST = sys.argv[5]
PATH_Y_PRE = sys.argv[6]

ALL_NUM_DATA_C1 = 7841
ALL_NUM_DATA_C2 = 24720
ALL_NUM_FEATURE = 106
ALL_NUM_DATA_TEST = 16281


NUM_ROW_WANTED_C1 = int(ALL_NUM_DATA_C1)
NUM_ROW_WANTED_C2 = int(ALL_NUM_DATA_C2)

ROW_WANTED_C1 = range(NUM_ROW_WANTED_C1)
ROW_WANTED_C2 = range(NUM_ROW_WANTED_C2)

ROW_WANTED_PRE_C1 = range(ALL_NUM_DATA_C1 - NUM_ROW_WANTED_C1, ALL_NUM_DATA_C1)
ROW_WANTED_PRE_C2 = range(ALL_NUM_DATA_C2 - NUM_ROW_WANTED_C2, ALL_NUM_DATA_C2)



x_test = DP.get_data(PATH_X_TEST, 0, ALL_NUM_FEATURE, 0, ALL_NUM_DATA_TEST)

mean_all = np.array([38.76745900128985,189435.6777839199,0.6670351943983784,1081.9051041090843,87.89926908666544,40.392236349118605,0.028990848227995823,0.06406240402923653,0.00018426386585590566,0.6885326454149008,0.03556292611018979,0.08113752226521713,0.04195074012652786,0.00042994902033044653,0.05914870093974572,0.02800810761009766,0.03912536085007064,0.013758368650574289,0.004852281800872182,0.010810146796879798,0.018979178183158283,0.014863951845709723,0.03279896812235121,0.04170505497205331,0.16399484061175604,0.011117253239972974,0.3244886677722499,0.0573674835698053,0.001965481235796327,0.015846692463607887,0.22031816227504453,0.13451262207481113,0.0008598980406608931,0.4547017996437565,0.012898470609913396,0.33376328235366376,0.031017750752410787,0.03224617652478349,0.11307659234690744,0.0003685277317118113,0.1236410539893127,0.12407100300964315,0.03046495915484307,0.04311774461028192,0.06264971439100793,0.09999385787113814,0.005712179841533075,0.12480805847306677,0.020514710398624163,0.11387506909894969,0.031816227504453044,0.0465573367729255,0.05933296480560162,0.40065106565935754,0.2627602727105215,0.03224617652478349,0.1543516982986303,0.10312634359068854,0.046864443216018674,0.009765984890363,0.029482218536944906,0.09587863153368957,0.008291873963515755,0.8565812910754868,0.000552791597567717,0.003746698605736748,0.002886800565075855,0.0015969535040845158,0.0026411154106013145,0.002026902524414962,0.0010441619065167987,0.003009643142313126,0.002272587678889503,0.000552791597567717,0.00423806891468583,0.0012284257723727044,0.0014741109268472453,0.0019040599471776918,0.0,0.00042994902033044653,0.0006142128861863522,0.0003685277317118113,0.0031324857195503962,0.0009827406178981636,0.0007984767520422579,0.001965481235796327,0.0015355322154658804,0.0018426386585590566,0.0003071064430931761,0.018917756894539648,0.0009213193292795283,0.000552791597567717,0.0009213193292795283,0.005957864996007616,0.001658374792703151,0.0018426386585590566,0.004299490203304466,0.000552791597567717,0.002149745101652233,0.0008598980406608931,0.0007370554634236226,0.0004913703089490818,0.9005589337264296,0.001167004483754069,0.00042994902033044653,0.01682943308150605])
var_all = np.array([191.78819481474622,11174955281.538092,0.2220992438322959,57512552.052968845,162483.89071932324,155.72416796723348,0.028150378947017135,0.0599584124192314,0.0001842299126836455,0.21445544161285923,0.034298204396670966,0.07455422474587851,0.04019087552936438,0.0004297641641703633,0.055650132116886256,0.027223653518198842,0.03759456698842239,0.013569075942649183,0.004828737162197106,0.010693287523109715,0.018618968978650213,0.014643014781238145,0.03172319581246019,0.03996574336183132,0.13710053286448073,0.010993659920371286,0.21919577225964032,0.05407645539867343,0.001961618119308059,0.015595574801571713,0.17177806964679165,0.11641897657737012,0.0008591586160205604,0.24794807304448563,0.01273210006583859,0.2223653537061723,0.0300556498906721,0.031206360624316,0.10029027661011874,0.0003683919190227708,0.10835394375772456,0.10867738922182425,0.029536845418536822,0.041258604710004435,0.05872472767773306,0.08999508625918477,0.005679550842991062,0.1092310070132503,0.020093857055884748,0.10090753773665913,0.03080395517183794,0.044389751165537894,0.055812564092978856,0.24012978924537873,0.19371731179561386,0.031206360624316,0.13052725153095895,0.09249130084830377,0.04466816717807125,0.009670610429484205,0.02861301732708474,0.08668591954891655,0.008223118789688925,0.122849782854939,0.0005524860190173756,0.003732660855294517,0.002878466947573333,0.0015944032435903082,0.002634139919989199,0.002022794190571482,0.0010430716324297778,0.0030005851904690516,0.002267423024131262,0.0005524860190173755,0.004220107686560202,0.0012269167424944752,0.0014719379238225944,0.0019004345028952455,0.0,0.0004297641641703632,0.0006138356287167952,0.0003683919190227708,0.0031226732527672094,0.0009817748387760971,0.0007978391869187059,0.0019616181193080596,0.0015331743562811478,0.0018392433413330408,0.0003070121287257869,0.01855987536861874,0.0009204704999730243,0.0005524860190173756,0.0009204704999730243,0.0059223688406969625,0.0016556245857500774,0.0018392433413330408,0.0042810045872961515,0.0005524860190173755,0.0021451236976501543,0.0008591586160205602,0.0007365122126674601,0.000491128864168565,0.08955254061194576,0.0011656425842889672,0.00042976416417036324,0.016546203263661158])



x_test_normalized = DP.normalization(x_test, mean_all, var_all)





w = np.array([0.3004652346105927,0.06671651293669656,0.23929367610121152,0.5128814801152904,0.321879206881257,0.31188281692173825,0.04386743903160095,-0.15045703947544098,-0.028589248657226562,-0.16624608635902405,0.029506221413612366,-0.25083161890506744,-0.14917239546775818,-0.03583957813680172,-0.5849289894104004,-0.4058876037597656,-0.437100887298584,-0.24004054069519043,-0.20055723190307617,-0.289412260055542,-0.42122554779052734,-0.3340637683868408,-0.2863492965698242,-0.31802845001220703,-0.2901287078857422,0.10103726387023926,-1.0145282745361328,-0.005580425262451172,-0.12412285804748535,0.06301641464233398,-0.7274694442749023,-0.03322339057922363,0.04273313283920288,0.4441927671432495,0.015179336071014404,-0.08122003078460693,0.0021500885486602783,0.013053983449935913,-0.0017566680908203125,-0.022414222359657288,-0.04669928550720215,0.36457014083862305,-0.15629041194915771,-0.10189437866210938,-0.10390043258666992,-0.06687355041503906,0.005557000637054443,0.18887829780578613,0.08783280849456787,0.10768699645996094,0.1065669059753418,-0.07815957069396973,0.40893077850341797,0.5127339363098145,-0.1524745225906372,-0.01549983024597168,-0.04442548751831055,-0.06916683912277222,0.4302787184715271,0.0032254457473754883,0.060717105865478516,0.08023262023925781,0.007585108280181885,0.143263578414917,0.042775630950927734,0.048569679260253906,-0.011218070983886719,-0.011806488037109375,0.029851913452148438,0.0061092376708984375,0.011286258697509766,0.0308685302734375,0.04336738586425781,0.02879190444946289,0.060393333435058594,-0.010690689086914062,0.030211448669433594,0.016626358032226562,-0.87261962890625,0.006592512130737305,0.007616519927978516,0.0058057308197021484,0.0070972442626953125,0.019530773162841797,0.029305458068847656,0.052318572998046875,0.02119588851928711,0.04567909240722656,-0.0035576820373535156,0.02490234375,-0.002154827117919922,-0.01831340789794922,0.0017757415771484375,0.06452274322509766,0.0115814208984375,0.007828235626220703,0.02034473419189453,0.00823068618774414,-0.011074066162109375,0.004802703857421875,0.0024361610412597656,0.003798961639404297,0.203338623046875,-0.004237174987792969,0.022554874420166016,0.028697967529296875])
b = -1.9932405395936934


b = np.array([b])


z = DP.get_z(w.T, b, x_test_normalized)



y_pre_C1 = np.array([])

for i in range(len(z)):

	if DP.sigmoid(z[i]) >= 0.5:
		y_pre_C1 = np.append(y_pre_C1, "1")
	
	else: 
		y_pre_C1 = np.append(y_pre_C1, "0")
	

idx = []
for i in range(len(y_pre_C1)):
	idx.append(i+1)
df_y_pre = pd.DataFrame(y_pre_C1, index = idx)


df_y_pre.to_csv(PATH_Y_PRE, index = True, header = ["label"], index_label = "id")
